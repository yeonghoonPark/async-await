"use strict";

/**
 * Synchronous: 'ë™ì‹œì— ì¼ì–´ë‚˜ëŠ”'
 * - ë™ê¸°ëŠ” ìš”ì²­ê³¼ ê²°ê³¼ê°€ ë™ì‹œì— ì¼ì–´ë‚œë‹¤.
 *   - ë™ê¸°í•¨ìˆ˜ì˜ ê²½ìš°, ìš”ì²­ì„ ë°›ìŒê³¼ ë™ì‹œì— ìš”ì²­ì— ëŒ€í•œ ê²°ê³¼ë¥¼ ì²˜ë¦¬í•´ì•¼ì§€ë§Œ ë‹¤ìŒ ì‘ì—…ì˜ ìš”ì²­ì„ ë°›ê³  ì§„í–‰í•  ìˆ˜ ìˆë‹¤.
 *
 * Asynchronous: 'ë™ì‹œì— ì¼ì–´ë‚˜ì§€ ì•ŠëŠ”'
 * - ë¹„ë™ê¸°ëŠ” ìš”ì²­ê³¼ ê²°ê³¼ê°€ ë™ì‹œì— ì¼ì–´ë‚˜ì§€ ì•ŠëŠ”ë‹¤.
 *   - ë¹„ë™ê¸°í•¨ìˆ˜ì˜ ê²½ìš°, ìš”ì²­ì„ ë°›ì€ í›„ ê²°ê³¼ë¥¼ ì²˜ë¦¬í•˜ì§€ ì•Šê³ ë„ ë‹¤ìŒ ì‘ì—…ì˜ ìš”ì²­ì„ ë°›ê³  ì§„í–‰í•  ìˆ˜ ìˆë‹¤.
 *   - browserê°€ ì œê³µí•˜ëŠ” API(ex: setTimeout())ì˜ ê²½ìš° ë¹„ë™ê¸°ë¡œ ë§Œë“¤ì–´ì ¸ ìˆë‹¤.
 */

// Synchronousì˜ ê²½ìš°, ì‘ì—…ì´ ìˆœì°¨ì ìœ¼ë¡œ ìœ„ì—ì„œ ì•„ë˜ë¡œ ìš”ì²­ì— ëŒ€í•œ ê²°ê³¼ë¥¼ ì²˜ë¦¬í•˜ê³  ë‹¤ìŒ ì‘ì—…ìœ¼ë¡œ ë„˜ì–´ê°„ë‹¤.
console.log("ì¼ë²ˆ");
console.log("ì´ë²ˆ");
console.log("ì‚¼ë²ˆ");
console.log("ì‚¬ë²ˆ");

// Asynchronousì˜ ê²½ìš°, ì‘ì—…ì´ ìˆœì°¨ì ìœ¼ë¡œ ìœ„ì—ì„œ ì•„ë˜ë¡œ ì§„í–‰í•˜ì§€ë§Œ ìš”ì²­ì„ ë°›ê³  ê²°ê³¼ë¥¼ setTimeoutì´ë€ ë¹„ë™ê¸°í•¨ìˆ˜ë¡œ delay timeì„ ì„¤ì •í–ˆê¸° ë•Œë¬¸ì— ê²°ê³¼ë¥¼ ì„¤ì •í•œ delay timeì— ì²˜ë¦¬í•œë‹¤.
// setTimeout(() => console.log("1ë²ˆ"), 7000);
// setTimeout(() => console.log("2ë²ˆ"), 5000);
// setTimeout(() => console.log("3ë²ˆ"), 3000);
console.log("4ë²ˆ");
// - ì¥ì : ê²°ê³¼ë¥¼ ë°”ë¡œ ì£¼ì§€ ì•Šê³ ë„ ë‹¤ìŒ ì‘ì—…ì— ëŒ€í•œ ìš”ì²­ì„ ë°›ê³  ë‹¤ìŒ ìš”ì²­ì— ëŒ€í•œ ê²°ê³¼ë¥¼ ë„ì¶œí•˜ëŠ” ê²ƒì„ ì§„í–‰í•  ìˆ˜ ìˆê¸°ì— ì†ë„ê°€ ë™ê¸°ì‹ì— ë¹„í•´ ë¹ ë¥´ë‹¤.
//        (ìœ„ì˜ setTimeoutì˜ˆì‹œì˜ ê²½ìš°, ë§Œì•½ ë¹„ë™ê¸°í•¨ìˆ˜ì¸ setTimeout ì•„ë‹ˆë¼ ë™ê¸°í•¨ìˆ˜ì˜€ë‹¤ë©´ ìˆœì°¨ì ìœ¼ë¡œ 7ì´ˆ, 5ì´ˆ ,3ì´ˆ í›„ì— 4ë²ˆì§¸ ì‘ì—…ì„ ì§„í–‰í•˜ê¸° ë•Œë¬¸ì— 4ë²ˆì§¸ ì‘ì—…ê¹Œì§€ ë„ë‹¬í•˜ëŠ” ì´ ì†Œìš”ì‹œê°„ì€ 15ì´ˆê°€ ë˜ê² ì§€ë§Œ ë¹„ë™ê¸°í•¨ìˆ˜ì˜ ê²½ìš°, ìš”ì²­ì— ëŒ€í•œ ê²°ê³¼ë¥¼ ì£¼ì§€ ì•Šê³ ë„ ë‹¤ìŒ ìš”ì²­ì„ ë°›ì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì´ ì†Œìš”ì‹œê°„ì€ 7ì´ˆì´ë‹¤.)
// - ë‹¨ì : ë§Œì•½ ì„ì˜ì ìœ¼ë¡œ ë¹„ë™ê¸°ì‹ì¸ setTimeoutìœ¼ë¡œ delay timeì„ ì„¤ì •í•  ìˆ˜ ì—†ëŠ” ë™ê¸°ì‹ í•¨ìˆ˜ì˜ ê²½ìš°ì—ì„œ 1ë²ˆì˜ ê²°ê³¼ê°’ì´ ë‚˜ì™€ì•¼ 2ë²ˆì„ ì‹¤í–‰í•  ìˆ˜ ìˆê³  2ë²ˆì˜ ê²°ê³¼ê°’ì´ ë‚˜ì™€ì•¼ 3ë²ˆì„ ì‹¤í–‰í•  ìˆ˜ ìˆê³  3ë²ˆì˜ ê²°ê³¼ê°’ì´ ë‚˜ì™€ì•¼ 4ë²ˆì„ ì‹¤í–‰ í•  ìˆ˜ ìˆëŠ” ìƒí™©ì´ë¼ë©´..?
//        ê·¸ ìƒí™©ì—ì„œ 1ë²ˆì§¸ í•¨ìˆ˜ì˜ ì‘ì—…ëŸ‰ì„ 100ê°œë¼ê³  ê°€ì •í•˜ê³  2,3,4ë²ˆì§¸ ì‘ì—…ëŸ‰ì„ 1ê°œë¼ê³  ê°€ì •í•œë‹¤ë©´ ë¹„ë™ê¸°ì‹ì˜ íŠ¹ì„±ìƒ ìš”ì²­ì— ëŒ€í•œ ê²°ê³¼ë¥¼ ë„ì¶œí•˜ì§€ ì•Šê³  ë‹¤ìŒ ì‘ì—…ì— ëŒ€í•œ ìš”ì²­ì„ ë°›ê¸° ë•Œë¬¸ì— 1ë²ˆì§¸ í•¨ìˆ˜ê°€ ê²°ê³¼ë¥¼ ë„ì¶œí•˜ëŠ” ë™ì•ˆ 2,3,4ë²ˆì§¸ë„ ìš”ì²­ì„ ë°›ê³  ê²°ê³¼ë¥¼ ë” ë¹ ë¥´ê²Œ ë„ì¶œí•˜ê¸° ë•Œë¬¸ì— ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.
//        ğŸº. í•´ê²°ì±…
//        *   1. ë¹„ë™ê¸°ì  callbackí•¨ìˆ˜ ì‚¬ìš©
//        *   2. ES6, Promise
//        *   3. ES8, async await

// 1. ë¹„ë™ê¸°ì  callbackí•¨ìˆ˜
const printWithDelay = (print, time) => {
  setTimeout(print, time);
};
printWithDelay(console.log("Two seconds have passed"), 2000);
// ë‹¨ì , ì½œë°±ì§€ì˜¥ì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤.

// 2. Promise ê°ì²´
// ë¹„ë™ê¸° methodì—ì„œ ë§ˆì¹˜ ë™ê¸° methodì²˜ëŸ¼ ê°’ì„ ë°˜í™˜í•  ìˆ˜ ìˆë‹¤, ë‹¤ë§Œ ìµœì¢… ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆê³ , ë¯¸ë˜ì˜ ì–´ë–¤ ì‹œì ì— ê²°ê³¼ë¥¼ ì œê³µí•˜ê² ë‹¤ëŠ” 'ì•½ì†'ì„ ë°˜í™˜í•œë‹¤.
//  ğŸ“Œ. Promiseì˜ 3ê°€ì§€ ìƒíƒœ(ë‹¤ìŒ ì¤‘ 1ê°€ì§€ì˜ ìƒíƒœë¥¼ ê°€ì§„ë‹¤.)
//  *   1. pending(ëŒ€ê¸°): fulfilled(ì´í–‰)ë„ rejected(ê±°ë¶€)ë„ í•˜ì§€ ì•Šì€ ìƒíƒœ
//  *   2. fulfilled(ì´í–‰): ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì–´ ì‘ë‹µ ë°›ì€ ìƒíƒœ
//  *   3. rejected(ê±°ë¶€): ìš”ì²­ì´ ì‹¤íŒ¨í•˜ì—¬ ì‘ë‹µ ë°›ëŠ”ë°ì— ì‹¤íŒ¨í•œ ìƒíƒœ
// then(): Promiseë¥¼ ë¦¬í„´í•˜ê³  2ê°œì˜ callbackí•¨ìˆ˜ë¥¼ parameterë¡œ ì„ ì–¸í•  ìˆ˜ ìˆë‹¤.
// ì²«ë²ˆì§¸ parameter: Promiseì˜ ìƒíƒœê°€ fulfilled(ì´í–‰)í–ˆì„ ë•Œì˜ callbackí•¨ìˆ˜
// ë‘ë²ˆì§¸ parameter: Promiseê°€ ìƒíƒœê°€ rejected(ê±°ë¶€)í–ˆì„ ë•Œì˜ callbackí•¨ìˆ˜
// ë‹¨ì , then() ì½œë°±ì§€ì˜¥ì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤.

// ğŸ“Œ. Promiseì™€ ì˜ async-awaitì°¨ì´ì 
//     * ì—ëŸ¬ í•¸ë“¤ë§
//       - Promise ì‚¬ìš©ì‹œ, .catch()ë¬¸ í†µí•´ ì—ëŸ¬ í•¸ë“¤ë§ ê°€ëŠ¥
//       - async await ì‚¬ìš©ì‹œ, try-catch()ë¬¸ì„ í†µí•´ ì—ëŸ¬ í•¸ë“¤ë§ ê°€ëŠ¥
// ğŸ“Œ. Promiseë³´ë‹¤ await asyncê°€ ê°€ì§€ëŠ” ì¥ì 
//     * ì½”ë“œ ê°€ë…ì„± ë° ë™ê¸°ì‹í™”
//       - Promiseì˜ ê²½ìš° .then().then().then()... (ê°€ë…ì„± ì €í•˜)
//       - async-awaitì˜ ê²½ìš° ë¹„ë™ê¸°ì½”ë“œê°€ ë™ê¸°ì½”ë“œì²˜ëŸ¼ ì½íˆê²Œ í•  ìˆ˜ ìˆë‹¤. (Promise ë¶ˆê°€ëŠ¥)

// REST-API url about coin
const url = "https://api.coinpaprika.com/v1/tickers";

// const getCoinData = () => axios.get(url);
// getCoinData().then((response) => response.data);

let promiseCnt = 0;
const testPromise = () => {
  let thisPromiseCnt = ++promiseCnt;
  const div = document.querySelector("#promise-div");
  div.insertAdjacentHTML(
    "beforeend",
    `${thisPromiseCnt}) ì‹œì‘ (<small> 1.ë™ê¸°ì  ì½”ë“œ ì‹œì‘</small> )<br/>`,
  );

  // new Promiseìƒì„±, Promiseì˜ ìƒì„± ìˆœì„œë¥¼ ì „ë‹¬í•˜ê² ë‹¤ëŠ” ì•½ì†ì„ í•¨ (3ì´ˆ)
  const promise = new Promise((resolve, reject) => {
    div.insertAdjacentHTML(
      "beforeend",
      `${thisPromiseCnt}) í”„ë¡œë¯¸ìŠ¤ ì‹œì‘ (<small> 2.ë¹„ë™ê¸°ì  ì½”ë“œ ì‹œì‘</small> )<br/>`,
    );
    setTimeout(() => resolve(thisPromiseCnt), 3000);
  });

  promise
    .then((value) =>
      div.insertAdjacentHTML(
        "beforeend",
        `${value}) í”„ë¡œë¯¸ìŠ¤ ì´í–‰ (<small> 3.ë¹„ë™ê¸°ì  ì½”ë“œ 3ì´ˆ í›„ ì¢…ë£Œ<small> )<br/>`,
      ),
    )
    .catch((reason) => {
      console.log(`ì—¬ê¸°ì„œ ê±°ë¶€ ëœ í”„ë¡œë¯¸ìŠ¤ ${reason}ì„ ì²˜ë¦¬í•˜ì„¸ìš”`);
    });

  div.insertAdjacentHTML(
    "beforeend",
    `${thisPromiseCnt}) í”„ë¡œë¯¸ìŠ¤ ìƒì„± (<small> 4.ë™ê¸°ì  ì½”ë“œ ì¢…ë£Œ<small> )<br/>`,
  );
};

const btn = document.querySelector("#promise-btn");
btn.addEventListener("click", testPromise);
